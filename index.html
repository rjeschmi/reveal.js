<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Quick overview of EasyBuild and Docker</title>

		<meta name="description" content="Using Docker to simplify clean builds for testing and package deployment">
		<meta name="author" content="Robert Schmidt">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/ohri.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Easybuild and Docker</h1>
					<h3>Building binary packages quickly and cleanly</h3>
					<p>
						Robert Schmidt|roschmidt@toh.ca
					</p>
					<img width="400px" style="bottom: 0; left: 0; border: none; background: none;" data-src="./images/TOH.png"/>
					<br/><img width="400px" style="bottom: 0; right:0;border: none; background: none;" data-src="./images/uOttawaAffil.png"/>
				</section>

				<section>
					<h2>Who am I?</h2>
					<ul>
						<li>Worked at SHARCNET until 2007</li>
						<li>Contributor to EasyBuild</li>
						<li>SysAdmin/Software Support for a bioinformatics group in a stem cell research program</li>
					</ul>
					<p class="fragment"><img width="400px" data-src="./images/bike.jpg"/><br/>
					I'm also crazy and bike to work in the winter <span class="fragment">... in Ottawa</span></p>
				</section>
				<section>
					<h2>What I hope to cover</h2>
					<p>
						<ul>
							<li class="fragment">EasyBuild highlights</li>
							<li class="fragment">Docker</li>
							<li class="fragment">Getting started</li>
						</ul>
					</p>
				</section>

				<section id="why-easybuild">
					<h2>What can EasyBuild do?</h2>
					<p>
						<a href="https://hpcugent.github.io/easybuild/">EasyBuild</a> is the product of an active community
						of HPC specialists world-wide.
					</p>
					<ul>
						<li class="fragment">Strict version resolution means easier community support</li>
						<li class="fragment">Can take fairly simple configs and turn them into built software</li>
						<li class="fragment">New version will make that even easier using YAML</li>
						<li class="fragment">Testing framework and good coverage</li>
						<li class="fragment">Future development includes support for rpath</li>
					</ul>

					<aside class="notes">
						User meetings
						Support
						github
					</aside>
				</section>

				<section id="why-docker">
					<h2>Why Docker?</h2>
						<ul>
							<li class="fragment">Isolation
								<ul>
									<li class="fragment">Runs in a separate process namespace, but lighter than a VM </li>
								</ul>
							</li>
							<li class="fragment">Clean
								<ul>
									<li class="fragment">Like chroot, active community, lots of software</li>
								</ul>
							</li>
							<li class="fragment">Already in use in environment</li>

						</ul>
					</p>
				</section>
				<section>
					<section>
						<h2>Some examples</h2>
						<pre><code data-trim data-noescape>
[easybuild@a68d53641587 ~]$ <mark>eb bzip2-1.0.6.eb --package</mark>
== temporary log file in case of crash /tmp/eb-fZ7Q26/easybuild-9n1eil.log
== processing EasyBuild easyconfig /software/easybuild-develop/easybuild-easyconfigs/easybuild/easyconfigs/b/bzip2/bzip2-1.0.6.eb
== building and installing bzip2/1.0.6...
== fetching files...
== creating build dir, resetting environment...
== unpacking...
== patching...
== preparing...
== configuring...
== building...
== testing...
== installing...
== taking care of extensions...
== postprocessing...
== sanity checking...
== cleaning up...
== creating module...
== permissions...
== packaging...
== COMPLETED: Installation ended successfully
== Results of the build can be found in the log file /software/easybuild/software/bzip2/1.0.6/easybuild/easybuild-bzip2-1.0.6-20160119.180510.log
== Build succeeded for 1 out of 1
== Temporary log file(s) /tmp/eb-fZ7Q26/easybuild-9n1eil.log* have been removed.
== Temporary directory /tmp/eb-fZ7Q26 has been removed.
					</code></pre>
					</section>
					<section>
						<pre><code>
[root@a68d53641587 build]# cd /software/easybuild/packages/
[root@a68d53641587 packages]# ls -ltra
total 492
-rw-rw-r-- 1 easybuild easybuild 494099 Jan 19 18:05 bzip2-1.0.6-eb_2.6.0.dev0-1.x86_64.rpm
drwxr-xr-x 8 easybuild easybuild   4096 Jan 19 18:05 ..
drwxrwxr-x 2 easybuild easybuild   4096 Jan 19 18:05 .
[root@a68d53641587 packages]# rpm -qlp bzip2-1.0.6-eb_2.6.0.dev0-1.x86_64.rpm
/software/easybuild/modules/all/bzip2/1.0.6
/software/easybuild/software/bzip2/1.0.6/bin/bunzip2
/software/easybuild/software/bzip2/1.0.6/bin/bzcat
/software/easybuild/software/bzip2/1.0.6/bin/bzcmp
/software/easybuild/software/bzip2/1.0.6/bin/bzdiff
/software/easybuild/software/bzip2/1.0.6/bin/bzegrep
/software/easybuild/software/bzip2/1.0.6/bin/bzfgrep
/software/easybuild/software/bzip2/1.0.6/bin/bzgrep
/software/easybuild/software/bzip2/1.0.6/bin/bzip2
/software/easybuild/software/bzip2/1.0.6/bin/bzip2recover
/software/easybuild/software/bzip2/1.0.6/bin/bzless
/software/easybuild/software/bzip2/1.0.6/bin/bzmore
/software/easybuild/software/bzip2/1.0.6/easybuild/bzip2-1.0.6-easybuild-devel
/software/easybuild/software/bzip2/1.0.6/include/bzlib.h
/software/easybuild/software/bzip2/1.0.6/lib/libbz2.a
/software/easybuild/software/bzip2/1.0.6/man/man1/bzcmp.1
/software/easybuild/software/bzip2/1.0.6/man/man1/bzdiff.1
/software/easybuild/software/bzip2/1.0.6/man/man1/bzegrep.1
/software/easybuild/software/bzip2/1.0.6/man/man1/bzfgrep.1
/software/easybuild/software/bzip2/1.0.6/man/man1/bzgrep.1
/software/easybuild/software/bzip2/1.0.6/man/man1/bzip2.1
/software/easybuild/software/bzip2/1.0.6/man/man1/bzless.1
/software/easybuild/software/bzip2/1.0.6/man/man1/bzmore.1
						</code></pre>

					</section>
					<section>
<pre><code>
rob@ogic:~/syncthing/eb-devel-install$ docker-compose run BuildToolchain help
usage: easy_build [-h] {build,yumrepo} ...
easy_build: error: invalid choice: 'help' (choose from 'build', 'yumrepo')

[nisrob@maraba eb-devel-install]$ docker-compose run BuildToolchain build foss-2015a foss-2015b

== temporary log file in case of crash /tmp/eb-VF8Idh/easybuild-rKb3Oe.log
== FPM/1.3.3-Ruby-2.1.6 is already installed (module found), skipping
== No easyconfigs left to be built.
== Build succeeded for 0 out of 0
== Temporary log file(s) /tmp/eb-VF8Idh/easybuild-rKb3Oe.log* have been removed.
== Temporary directory /tmp/eb-VF8Idh has been removed.
calling eb with args: ['--package', '--sourcepath=/export/easybuild/sources', '--download-timeout=60', '--prefix=/software/easybuild', '--packagepath=/repos/foss-2015a', 'foss-2015a.eb', '--robot']
== temporary log file in case of crash /tmp/eb-gJ2eZa/easybuild-NdTeem.log
== resolving dependencies ...
== processing EasyBuild easyconfig /software/easybuild-develop/easybuild-easyconfigs/easybuild/easyconfigs/g/GCC/GCC-4.9.2.eb
== building and installing GCC/4.9.2...
== fetching files...
== creating build dir, resetting environment...
== unpacking...

...


</code></pre>
					</section>
				</section>
				<section >
					<iframe class="stretch" data-src="http://tecc-demo.ottbioinfo.ca/"></iframe>
				</section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
				parallaxBackgroundImage: 'https://raw.githubusercontent.com/rjeschmi/reveal.js/eb-docker-tecc-2016-toronto/parl_winter_blur.jpg',
				parallaxBackgroundSize: '1905px 900px',
				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
